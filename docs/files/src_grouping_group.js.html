<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/grouping/group.js - xeoengine</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">

                <h1 style="color:white;"><a href="../../">xeoEngine</a> / <a href="../../docs">API Documentation</a></h1>

            <ul class="nav navbar-nav navbar-right">
                <li class=""><a href="#banner">Home</a></li>
                <li class=""><a href="#concept">Concept</a></li>
                <li class="active"><a href="#features">Features</a></li>
                <li><a href="http://xeoengine.org/examples">Examples</a></li>
                <li><a href="http://xeoengine.org/docs">Docs</a></li>
                <li><a href="https://github.com/xeolabs/xeoengine">Github</a></li>
                <li>
                    <a href="https://github.com/xeolabs/xeoengine/archive/master.zip">Download</a>
                </li>
            </ul>

        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AmbientLight.html">AmbientLight</a></li>
                                <li><a href="../classes/Billboard.html">Billboard</a></li>
                                <li><a href="../classes/Boundary2D.html">Boundary2D</a></li>
                                <li><a href="../classes/Boundary3D.html">Boundary3D</a></li>
                                <li><a href="../classes/BoundaryGeometry.html">BoundaryGeometry</a></li>
                                <li><a href="../classes/BoxGeometry.html">BoxGeometry</a></li>
                                <li><a href="../classes/Camera.html">Camera</a></li>
                                <li><a href="../classes/CameraControl.html">CameraControl</a></li>
                                <li><a href="../classes/CameraFlight.html">CameraFlight</a></li>
                                <li><a href="../classes/CameraPath.html">CameraPath</a></li>
                                <li><a href="../classes/Canvas.html">Canvas</a></li>
                                <li><a href="../classes/Clip.html">Clip</a></li>
                                <li><a href="../classes/Clips.html">Clips</a></li>
                                <li><a href="../classes/ColorBuf.html">ColorBuf</a></li>
                                <li><a href="../classes/ColorTarget.html">ColorTarget</a></li>
                                <li><a href="../classes/Component.html">Component</a></li>
                                <li><a href="../classes/Configs.html">Configs</a></li>
                                <li><a href="../classes/CubicBezierCurve.html">CubicBezierCurve</a></li>
                                <li><a href="../classes/Curve.html">Curve</a></li>
                                <li><a href="../classes/CylinderGeometry.html">CylinderGeometry</a></li>
                                <li><a href="../classes/DepthBuf.html">DepthBuf</a></li>
                                <li><a href="../classes/DepthTarget.html">DepthTarget</a></li>
                                <li><a href="../classes/DirLight.html">DirLight</a></li>
                                <li><a href="../classes/Entity.html">Entity</a></li>
                                <li><a href="../classes/Fresnel.html">Fresnel</a></li>
                                <li><a href="../classes/Frustum.html">Frustum</a></li>
                                <li><a href="../classes/Geometry.html">Geometry</a></li>
                                <li><a href="../classes/Group.html">Group</a></li>
                                <li><a href="../classes/GroupBoundary.html">GroupBoundary</a></li>
                                <li><a href="../classes/Input.html">Input</a></li>
                                <li><a href="../classes/KeyboardAxisCamera.html">KeyboardAxisCamera</a></li>
                                <li><a href="../classes/KeyboardPanCamera.html">KeyboardPanCamera</a></li>
                                <li><a href="../classes/KeyboardRotateCamera.html">KeyboardRotateCamera</a></li>
                                <li><a href="../classes/KeyboardZoomCamera.html">KeyboardZoomCamera</a></li>
                                <li><a href="../classes/LatheGeometry.html">LatheGeometry</a></li>
                                <li><a href="../classes/Layer.html">Layer</a></li>
                                <li><a href="../classes/Lights.html">Lights</a></li>
                                <li><a href="../classes/Lookat.html">Lookat</a></li>
                                <li><a href="../classes/Material.html">Material</a></li>
                                <li><a href="../classes/Model.html">Model</a></li>
                                <li><a href="../classes/Modes.html">Modes</a></li>
                                <li><a href="../classes/MorphTargets.html">MorphTargets</a></li>
                                <li><a href="../classes/MousePanCamera.html">MousePanCamera</a></li>
                                <li><a href="../classes/MousePickEntity.html">MousePickEntity</a></li>
                                <li><a href="../classes/MouseRotateCamera.html">MouseRotateCamera</a></li>
                                <li><a href="../classes/MouseZoomCamera.html">MouseZoomCamera</a></li>
                                <li><a href="../classes/Ortho.html">Ortho</a></li>
                                <li><a href="../classes/Path.html">Path</a></li>
                                <li><a href="../classes/PathGeometry.html">PathGeometry</a></li>
                                <li><a href="../classes/PBRMaterial.html">PBRMaterial</a></li>
                                <li><a href="../classes/Perspective.html">Perspective</a></li>
                                <li><a href="../classes/PhongMaterial.html">PhongMaterial</a></li>
                                <li><a href="../classes/PlaneGeometry.html">PlaneGeometry</a></li>
                                <li><a href="../classes/PointLight.html">PointLight</a></li>
                                <li><a href="../classes/QuadraticBezierCurve.html">QuadraticBezierCurve</a></li>
                                <li><a href="../classes/Quaternion.html">Quaternion</a></li>
                                <li><a href="../classes/Reflect.html">Reflect</a></li>
                                <li><a href="../classes/Rotate.html">Rotate</a></li>
                                <li><a href="../classes/Scale.html">Scale</a></li>
                                <li><a href="../classes/Scene.html">Scene</a></li>
                                <li><a href="../classes/Shader.html">Shader</a></li>
                                <li><a href="../classes/ShaderParams.html">ShaderParams</a></li>
                                <li><a href="../classes/Skybox.html">Skybox</a></li>
                                <li><a href="../classes/SphereGeometry.html">SphereGeometry</a></li>
                                <li><a href="../classes/SplineCurve.html">SplineCurve</a></li>
                                <li><a href="../classes/Stage.html">Stage</a></li>
                                <li><a href="../classes/Stationary.html">Stationary</a></li>
                                <li><a href="../classes/Task.html">Task</a></li>
                                <li><a href="../classes/Tasks.html">Tasks</a></li>
                                <li><a href="../classes/Texture.html">Texture</a></li>
                                <li><a href="../classes/TorusGeometry.html">TorusGeometry</a></li>
                                <li><a href="../classes/Transform.html">Transform</a></li>
                                <li><a href="../classes/Translate.html">Translate</a></li>
                                <li><a href="../classes/Visibility.html">Visibility</a></li>
                                <li><a href="../classes/XEO.html">XEO</a></li>
                                <li><a href="../classes/XEO.math.math.html">XEO.math.math</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/animation.html">animation</a></li>
                                <li><a href="../modules/boundaries.html">boundaries</a></li>
                                <li><a href="../modules/camera.html">camera</a></li>
                                <li><a href="../modules/canvas.html">canvas</a></li>
                                <li><a href="../modules/clipping.html">clipping</a></li>
                                <li><a href="../modules/configs.html">configs</a></li>
                                <li><a href="../modules/controls.html">controls</a></li>
                                <li><a href="../modules/culling.html">culling</a></li>
                                <li><a href="../modules/curves.html">curves</a></li>
                                <li><a href="../modules/entities.html">entities</a></li>
                                <li><a href="../modules/geometry.html">geometry</a></li>
                                <li><a href="../modules/grouping.html">grouping</a></li>
                                <li><a href="../modules/importing.html">importing</a></li>
                                <li><a href="../modules/input.html">input</a></li>
                                <li><a href="../modules/lighting.html">lighting</a></li>
                                <li><a href="../modules/materials.html">materials</a></li>
                                <li><a href="../modules/math.html">math</a></li>
                                <li><a href="../modules/rendering.html">rendering</a></li>
                                <li><a href="../modules/reporting.html">reporting</a></li>
                                <li><a href="../modules/shaders.html">shaders</a></li>
                                <li><a href="../modules/skyboxes.html">skyboxes</a></li>
                                <li><a href="../modules/transforms.html">transforms</a></li>
                                <li><a href="../modules/XEO.html">XEO</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <!--<div id="api-options">-->
                    <!--Show:-->
                    <!--<label for="api-show-inherited">-->
                        <!--<input type="checkbox" id="api-show-inherited" checked>-->
                        <!--Inherited-->
                    <!--</label>-->
            
                    <!--<label for="api-show-protected">-->
                        <!--<input type="checkbox" id="api-show-protected">-->
                        <!--Protected-->
                    <!--</label>-->
            
                    <!--<label for="api-show-private">-->
                        <!--<input type="checkbox" id="api-show-private">-->
                        <!--Private-->
                    <!--</label>-->
                    <!--<label for="api-show-deprecated">-->
                        <!--<input type="checkbox" id="api-show-deprecated">-->
                        <!--Deprecated-->
                    <!--</label>-->
            
                <!--</div>-->
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/grouping/group.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 A **Group** is a collection of {{#crossLink &quot;Component&quot;}}Components{{/crossLink}}.

 ## Overview

 &lt;ul&gt;
 &lt;li&gt;Supports addition and removal of {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} by instance, ID or type.&lt;/li&gt;
 &lt;/ul&gt;

 &lt;img src=&quot;../../../assets/images/Group.png&quot;&gt;&lt;/img&gt;

 ## Example


 &#x60;&#x60;&#x60;&#x60;javascript
 var material = new XEO.PhongMaterial({
     id: &quot;myMaterial&quot;,
     diffuse: [0.5, 0.5, 0.0]
 });

 var geometry = new XEO.BoxGeometry();

 var Entity = new XEO.Entity({
    id: &quot;myEntity&quot;,
    material: material,
    geometry: geometry
 });

 // Our first group contains the Material, added by ID,
 // plus the Geometry and Entity, both added by instance.

 var group1 = new XEO.Group({ // Initialize with three components
    components: [
        &quot;myMaterial&quot;,
        geometry,
        Entity
    ]
 });

 // Our second Group includes the geometry, added by instance,
 // and the Entity, added by type. If there were more than
 // one Entity in the scene, then that type would ensure
 // that all the Entities were in the Group.

 var group2 = new XEO.Group();

 group2.add([  // Add two components
    geometry,
    &quot;XEO.Entity&quot;,
 ]);

 // We can iterate over the components in a Group like so:

 group1.iterate(
    function(component) {
        //..
    });

 // And remove components from a Group
 // by instance, ID or type:

 group1.remove(&quot;myMaterial&quot;); // Remove one component by ID
 group1.remove([geometry, Entity]); // Remove two components by instance

 group2.remove(&quot;XEO.Geometry&quot;); // Remove all Geometries
 &#x60;&#x60;&#x60;&#x60;

 TODO

 @class Group
 @module XEO
 @submodule grouping
 @constructor
 @param [scene] {Scene} Parent {{#crossLink &quot;Scene&quot;}}{{/crossLink}}.
 @param [cfg] {*} Configs
 @param [cfg.id] {String} Optional ID, unique among all components in the parent scene, generated automatically when omitted.
 @param [cfg.meta] {String:Component} Optional map of user-defined metadata to attach to this Group.
 @param [cfg.components] {{Array of String|Component}} Array of {{#crossLink &quot;Component&quot;}}{{/crossLink}} IDs or instances.
 @extends Component
 */
(function () {

    &quot;use strict&quot;;

    XEO.Group = XEO.Component.extend({

        /**
         JavaScript class name for this Component.

         @property type
         @type String
         @final
         */
        type: &quot;XEO.Group&quot;,

        _init: function (cfg) {

            /**
             * The {{#crossLink &quot;Components&quot;}}{{/crossLink}} within this Group, mapped to their IDs.
             *
             * Fires an {{#crossLink &quot;Group/updated:event&quot;}}{{/crossLink}} event on change.
             *
             * @property components
             * @type {{String:Component}}
             */
            this.components = {};

            /**
             * The number of {{#crossLink &quot;Components&quot;}}{{/crossLink}} within this Group.
             *
             * @property numComponents
             * @type Number
             */
            this.numComponents = 0;

            /**
             * A map of maps; for each {{#crossLink &quot;Component&quot;}}{{/crossLink}} type in this Group,
             * a map to IDs to {{#crossLink &quot;Component&quot;}}{{/crossLink}} instances, eg.
             *
             * &#x60;&#x60;&#x60;&#x60;
             * &quot;XEO.Geometry&quot;: {
             *   &quot;alpha&quot;: &lt;XEO.Geometry&gt;,
             *   &quot;beta&quot;: &lt;XEO.Geometry&gt;
             * },
             * &quot;XEO.Rotate&quot;: {
             *   &quot;charlie&quot;: &lt;XEO.Rotate&gt;,
             *   &quot;delta&quot;: &lt;XEO.Rotate&gt;,
             *   &quot;echo&quot;: &lt;XEO.Rotate&gt;,
             * },
             * //...
             * &#x60;&#x60;&#x60;&#x60;
             *
             * @property types
             * @type {String:{String:XEO.Component}}
             */
            this.types = {};

            // Subscriptions to &quot;destroyed&quot; events from components
            this._destroyedSubs = {};

            if (cfg.components) {
                this.add(cfg.components);
            }
        },

        /**
         * Adds one or more {{#crossLink &quot;Component&quot;}}Components{{/crossLink}}s to this Group.
         *
         * The {{#crossLink &quot;Component&quot;}}Component(s){{/crossLink}} may be specified by instance, ID or type.
         *
         * See class comment for usage examples.
         *
         * The {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} must be in the same {{#crossLink &quot;Scene&quot;}}{{/crossLink}} as this Group.
         *
         * Fires an {{#crossLink &quot;Group/added:event&quot;}}{{/crossLink}} event.
         *
         * @method add
         * @param {Array of Component} components Array of {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} instances.
         */
        add: function (components) {

            components = XEO._isArray(components) ? components : [components];

            for (var i = 0, len = components.length; i &lt; len; i++) {
                this._add(components[i]);
            }
        },

        _add: function (c) {

            var componentId;
            var component;
            var type;
            var types;

            if (c.type) {

                // Component instance

                component = c;

            } else if (XEO._isNumeric(c) || XEO._isString(c)) {

                if (this.scene.types[c]) {

                    // Component type

                    type = c;

                    types = this.scene.types[type];

                    if (!types) {
                        this.warn(&quot;Component type not found: &#x27;&quot; + type + &quot;&#x27;&quot;);
                        return;
                    }

                    for (componentId in types) {
                        if (types.hasOwnProperty(componentId)) {
                            this._add(types[componentId]);
                        }
                    }

                    return;

                } else {

                    // Component ID

                    component = this.scene.components[c];

                    if (!component) {
                        this.warn(&quot;Component not found: &quot; + XEO._inQuotes(c));
                        return;
                    }
                }

            } else {

                return;
            }

            if (component.scene != this.scene) {

                // Component in wrong Scene

                this.warn(&quot;Attempted to add component from different XEO.Scene: &quot; + XEO._inQuotes(component.id));
                return;
            }

            // Add component to this map

            if (this.components[component.id]) {

                // Component already in this Group
                return;
            }

            this.components[component.id] = component;

            // Register component for its type

            types = this.types[component.type];

            if (!types) {
                types = this.types[type] = {};
            }

            types[component.id] = component;

            this.numComponents++;

            // Remove component when it&#x27;s destroyed

            var self = this;

            this._destroyedSubs[component.id] = component.on(&quot;destroyed&quot;,
                function (component) {
                    self._remove(component);
                });

            /**
             * Fired whenever an individual {{#crossLink &quot;Component&quot;}}{{/crossLink}} is added to this {{#crossLink &quot;Group&quot;}}{{/crossLink}}.
             * @event added
             * @param value {Component} The {{#crossLink &quot;Component&quot;}}{{/crossLink}} that was added.
             */
            this.fire(&quot;added&quot;, component);

            if (!this._dirty) {
                this._scheduleUpdate();
            }
        },

        _scheduleUpdate: function () {
            if (!this._dirty) {
                this._dirty = true;
                XEO.scheduleTask(this._notifyUpdated, this);
            }
        },

        _notifyUpdated: function () {

            /* Fired on the next {{#crossLink &quot;Scene/tick.animate:event&quot;}}{{/crossLink}} whenever
             * {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} were added or removed since the
             * last {{#crossLink &quot;Scene/tick.animate:event&quot;}}{{/crossLink}} event, to provide a batched change event
             * for subscribers who don&#x27;t want to react to every individual addition or removal on this Group.
             *
             * @event updated
             */
            this.fire(&quot;updated&quot;);
            this._dirty = false;
        },

        /**
         * Removes all {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} from this Group.
         *
         * Fires an {{#crossLink &quot;Group/updated:event&quot;}}{{/crossLink}} event.
         *
         * @method clear
         */
        clear: function () {

            this.iterate(function (component) {
                this._remove(component);
            });
        },

        /**
         * Destroys all {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} in this Group.
         *
         * @method destroyAll
         */
        destroyAll: function () {

            this.iterate(function (component) {
                component.destroy();
            });
        },

        /**
         * Removes one or more {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} from this Group.
         *
         * The {{#crossLink &quot;Component&quot;}}Component(s){{/crossLink}} may be specified by instance, ID or type.
         *
         * See class comment for usage examples.
         *
         * Fires a {{#crossLink &quot;Group/removed:event&quot;}}{{/crossLink}} event.
         *
         * @method remove
         * @param {Array of Components} components Array of {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} instances.
         */
        remove: function (components) {

            components = XEO._isArray(components) ? components : [components];

            for (var i = 0, len = components.length; i &lt; len; i++) {
                this._remove(components[i]);
            }
        },

        _remove: function (component) {

            var componentId = component.id;

            if (component.scene != this.scene) {
                this.warn(&quot;Attempted to remove component that&#x27;s not in same XEO.Scene: &#x27;&quot; + componentId + &quot;&#x27;&quot;);
                return;
            }

            delete this.components[componentId];

            // Unsubscribe from component destruction

            component.off(this._destroyedSubs[componentId]);

            delete this._destroyedSubs[componentId];

            // Unregister component for its type

            var types = this.types[component.type];

            if (types) {
                delete types[component.id];
            }

            this.numComponents--;

            /**
             * Fired whenever an individual {{#crossLink &quot;Component&quot;}}{{/crossLink}} is removed from this {{#crossLink &quot;Group&quot;}}{{/crossLink}}.
             * @event removed
             * @param value {Component} The {{#crossLink &quot;Component&quot;}}{{/crossLink}} that was removed.
             */
            this.fire(&quot;removed&quot;, component);

            if (!this._dirty) {
                this._scheduleUpdate();
            }
        },

        /**
         * Iterates with a callback over the {{#crossLink &quot;Component&quot;}}Components{{/crossLink}} in this Group.
         *
         * @method iterate
         * @param {Function} callback Callback called for each {{#crossLink &quot;Component&quot;}}{{/crossLink}}.
         * @param {Object} [scope=this] Optional scope for the callback, defaults to this Group.
         */
        iterate: function (callback, scope) {
            scope = scope || this;
            for (var componentId in this.components) {
                if (this.components.hasOwnProperty(componentId)) {
                    callback.call(scope, this.components[componentId]);
                }
            }
        },

        _getJSON: function () {

            var componentIds = [];

            for (var componentId in this.components) {
                if (this.components.hasOwnProperty(componentId)) {
                    componentIds.push(this.components[componentId].id); // Don&#x27;t convert numbers into strings
                }
            }

            return {
                components: componentIds
            };
        },

        _destroy: function () {

            this.clear();
        }
    });

})();
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
